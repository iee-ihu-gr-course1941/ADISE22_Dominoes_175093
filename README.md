# ADISE22_Dominoes_175093


Table of Contents
=================
   * [Εγκατάσταση](#εγκατάσταση)
      * [Απαιτήσεις](#απαιτήσεις)
      * [Οδηγίες Εγκατάστασης](#οδηγίες-εγκατάστασης)
   * [Περιγραφή API](#περιγραφή-api)
      * [Methods](#methods)
         * [Board](#board)
            * [Ανάγνωση Board](#ανάγνωση-board)
            * [Αρχικοποίηση Board](#αρχικοποίηση-board)
         * [Piece](#piece)
            * [Ανάγνωση Θέσης/Πιονιού](#ανάγνωση-θέσηςπιονιού)
            * [Μεταβολή Θέσης Πιονιού](#μεταβολή-θέσης-πιονιού)
         * [Status](#status)
         * [Update] (#update)
         * [Player1](#player1)
         * [Player2](#player2)
         * [Takepiece](#takepiece)
         * [Playersinfo](#players_info)
         * [Reset](#Reset)

         
      * [Entities](#entities)
        * [Allpieces](#allpieces)
         * [Board](#board-1)
         * [Empty Board](#board_empty)
         * [Game_status](#game_status)
        * [Piecesp1](#piecesp1)
         * [Piecesp2](#piecesp2)
         * [Players](#players)



# Demo Page

Μπορείτε να κατεβάσετε τοπικά ή να επισκευτείτε την σελίδα: 
https://users.it.teithe.gr/~it175093/ADISE22_Dominoes_175093/www/



# Εγκατάσταση

## Απαιτήσεις

* Apache2
* Mysql Server
* php

## Οδηγίες Εγκατάστασης

 * Κάντε clone το project σε κάποιον φάκελο <br/>
  `$ git clone https://github.com/iee-ihu-gr-course1941/ADISE22_Dominoes_175093`

 * Βεβαιωθείτε ότι ο φάκελος είναι προσβάσιμος από τον Apache Server. πιθανόν να χρειαστεί να καθορίσετε τις παρακάτω ρυθμίσεις.

 * Θα πρέπει να δημιουργήσετε στην Mysql την βάση με όνομα 'dominoes' και να φορτώσετε σε αυτήν την βάση τα δεδομένα από το αρχείο dominoes_schema.sql

 * Θα πρέπει να φτιάξετε το αρχείο lib/db_upass.php το οποίο να περιέχει:
```
    <?php
	$DB_PASS = '';
	$DB_USER = 'root';
    ?>
```

# Περιγραφή Παιχνιδιού

Το ντομινο ειναι ενα  παιχνιδι πλακιδίων που πανω τους υπαρχουν αριθμοι σε δυο μεριες.Οι παίχτες αναλογα με τα με τα πλακίδια που εχουν παιχτεί στο board προσπαθούν να ξεφορτωθουν τα πλακιαδια που τους έχουν μοιραστεί στο ξεκίνημα του παιχνιδίου. Αυτός που θα ξεφορτωθεί πρώτος τα πλακίδια του κερδίζει.Στην αρχη του παιχνιδιού για να ρυθμιστεί ποιος θα παίζει πρώτος, ο καθε παιχτης επιλέγει τυχαια ενα πλακίδιο, αυτός που έχει το μεγαλύτερο παίζει πρωτος.Αφου επιλεγεί η σειρά των παικτών μοιραζονται επτα τυχαια πλακιδια στο καθενα. Ο καθε παιχτης στη γυρα του μπορει να παρει απο ενα πλακιδιο αν δεν εχει καποια κινηση να κανει.


Οι κανόνες είναι τα πλακίδια να τοποθετουνται  παντα με τον ιδιο αριθμο  οταν παιζονται στο board  απο τους χρηστες. Οι κινησεις πρεπει να ειναι διαδοχικες των πλακιδιων.Οταν καποιος αριθμος  στα δυο μερη του πλακιδίου ειναι ιδιος, το πλακιδιο πρεπει να παίζεται κάθετα αλλιως θα παιζεται οριζόντια.

Η βάση μας κρατάει τους εξής πίνακες  : 
 allpieces | ολα πλακίδια  και ποιοι ειναι οι παιχτες που τα ειχαν ή εχουν στη κατοχη τους     

 board     | το board των κινησεων

 board_empty| ιδιος με το board μας  βοηθαει να κανουμε reset των πινακα

 game_status| κραταει το status του παιχνιδιου   

 piecesp1  | τα πλακίδια που εχει ο παιχτης 1 στο χερι του 

 piecesp2  | τα πλακίδια που εχει ο παιχτης 2 στο χερι του  

 players    |  οι πληροφοριες για τους παιχτες       



Η εφαρμογή απαπτύχθηκε μεχρι το σημείο που υπάρχει νικητης στο παιχνίδι χωρις τον ελεγχο το παιχνιδι να σταματαει αν δεν υπαρχουν αλλες κινησεις (blocked).
Yλοποιηθηκαν τα εξης :
* Αρχικοποίηση σύνδεσης-authentication 
* Έλεγχος κανόνων παιχνιδιού.
* Αναγνώριση σειράς παιξιάς.
* Το APΙ να χρησιμοποιεί json μορφή για τα δεδομένα.
* Γραφική εμφάνιση του board η εντολή κίνησης να δίνεται από textarea/input text και όχι με το ποντίκι
* Η κατάσταση του παιχνιδιού αποθηκεύεται πλήρως σε mysql.
* Ο πρώτος παίκτης αρχικοποιεί το board και περιμένει αντίπαλο όπου χρειάζεται.


* Έλεγχος timeout → ακύρωση παίκτη



## Συντελεστές

Μυρόβαλης Αλκιβιάδης: Jquery ,PHP API , Σχεδιασμός mysql


# Περιγραφή API






## Methods


### Board
#### Ανάγνωση Board

```
GET /board/
```

Επιστρέφει το [Board](#Board).

#### Αρχικοποίηση Board
```
POST /board/
```

Αρχικοποιεί το Board, δηλαδή το παιχνίδι. Γίνονται reset τα πάντα σε σχέση με το παιχνίδι.
Επιστρέφει το [Board](#Board).

### Piece
#### Ανάγνωση Θέσης/Πιονιού

```
GET /board/piece/:x/:y/
```

Κάνει την κίνηση του πιονιού από την θέση x,y στην νέα θέση. Προφανώς ελέγχεται η κίνηση αν είναι νόμιμη καθώς και αν είναι η σειρά του παίκτη να παίξει με βάση το token.
Επιστρέφει τα στοιχεία από το [Board](#Board-1) με συντεταγμένες x.
 

#### Μεταβολή Θέσης Πιονιού

```
PUT /board/piece/:x/:y/
```
Json Data:

| Field             | Description                 | Required   |
| ----------------- | --------------------------- | ---------- |
| `x`               | Η θέση x απ το πινακα piecesp1| yes        |
| `y`               | Η θεση Χ στον πινακα board  | yes        |

Επιστρέφει τα στοιχεία από το [Board](#Board-1) με συντεταγμένες x,y.
Περιλαμβάνει το χρώμα του πιονιού και τον τύπο

### Status

#### Ανάγνωση κατάστασης παιχνιδιού
```
GET /status/
```

Επιστρέφει το στοιχείο [Game_status](#Game_status).




### Update

#### Ελεγχος για τερματισμό
```
GET /update/
```

  Ελεγχει αν το παιχνιδι εχει τελειωσει ή εχει τελειωσει το session για την συγκεκριμενη παρτιδα. Αν εχει γινει καποια αλλαγη ανανεωνει το game_status με τις νεες τιμες.




###  player1
####  Στοιχεια παίκτη 1
```
GET /player1/
```

Επιστρέφει  τα πλακίδια με τη θεση τους του παίκτη 1 .


###  player2
####  Στοιχεια παίκτη 2
```
GET /player2/
```

Επιστρέφει  τα πλακίδια με τη θεση τους του παίκτη 2 .


 ###  takepiece
####  Ο παιχτης τραβα πλακίδιο 
```
POST /takepiece/
```

Γινεται κληση της μεθοδου  take_piece2() που εισάγει σε κενο κελι του πινακα piecesp1 ενα πλακίδιο απο τον πινακα allpieces  και επιστρεφει το board 


 ###  players_info
####  εμφανιση των παιχτων 
```
GET /players_info/1
GET /players_info/2
```

Επιστρεφει το username και τη θεση που καθεται ο παικτης 1 ή ο δυο αντιστοιχα.


####  Γινεται εκχώρηση των παιχτών 

```
POST /players_info/1
POST /players_info/2
```

Καταχωρει τα στοιχεια για τους παιχτες 1 ή 2.


 ###  Reset
####  Επανεκκινηση του παιχνιδιου
```
POST /reset/
```

Καλει την μεθοδο που κανει reset τα ολα στοιχεια απ τη βαση 



## Entities

### Allpieces
---------

Καταχωρουνται ολα πλακίδια μαζι με τον αριθμο του παιχτη που τα κατέχει


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `x`                      | H συντεταγμένη x του τετραγώνου              |  1..28                              |
| `piece`                  | To Πιόνι που υπάρχει στο τετράγωνο           |  0_1,0_2.....5_6, 6_6               |
| `player`                 | To Πιόνι που υπάρχει στο τετράγωνο           |  '1','2' ,null                      |




### Board
---------

Το board είναι ένας πίνακας, ο οποίος στο κάθε στοιχείο έχει τα παρακάτω:


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `x`                      | H συντεταγμένη x του τετραγώνου              | 1..28                                |
| `piece`                  | To Πιόνι που υπάρχει στο τετράγωνο           | 0_1,0_2.....5_6, 6_6                |



### Board_empty
---------

Το board είναι ένας πίνακας, ο οποίος στο κάθε στοιχείο έχει τα παρακάτω:


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `x`                      | H συντεταγμένη x του τετραγώνου              | 1..28                                |
| `piece`                  | To Πιόνι που υπάρχει στο τετράγωνο           | 0_1,0_2.....5_6, 6_6                |


### Game_status
---------

H κατάσταση παιχνιδιού έχει τα παρακάτω στοιχεία:


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `status  `               | Κατάσταση             | 'not active', 'initialized', 'started', 'ended', 'aborded' |
| `seast_turn`             | To χρώμα του παίκτη που παίζει               | '1','2',null                        |
| `result`                 |  To χρώμα του παίκτη που κέρδισε |'A','B',null                                     |
| `last_change`            | Τελευταία αλλαγή/ενέργεια στην κατάσταση του παιχνιδιού         | timestamp        |


### Piecesp1
---------

 Ο πίνακας αυτος μας δινει τι κραταει στα χερια του ο παιχτης 1


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `x`                      | H συντεταγμένη x του τετραγώνου              | 1..28                               |
| `piece`                  | To Πιόνι που υπάρχει στο τετράγωνο           | 0_1,0_2.....5_6, 6_6                |
| `playerseat`             |                                              |'1','2',null                         |
 


### Piecesp2
---------

 Ο πίνακας αυτος μας δινει τι κραταει στα χερια του ο παιχτης 1


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `x`                      | H συντεταγμένη x του τετραγώνου              | 1..28                               |
| `piece`                  | To Πιόνι που υπάρχει στο τετράγωνο           | 0_1,0_2.....5_6, 6_6                |
| `playerseat`             |                                              |'1','2',null                         |
 




### Players
---------

O κάθε παίκτης έχει τα παρακάτω στοιχεία:


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `username`               | Όνομα παίκτη                                 | String                              |
| `seat`                   | To χρώμα που παίζει ο παίκτης                | '1','2'                          |
| `token  `                | To κρυφό token του παίκτη. Επιστρέφεται μόνο τη στιγμή της εισόδου του παίκτη στο παιχνίδι | HEX |
| `last_action`            | Τελευταια αλλαγη στο login                   | timestamp                           |


